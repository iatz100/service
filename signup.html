<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sign Up | Social Service</title>
<!-- Add Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<style>
    :root {
        --primary-color: #4a6bff;
        --secondary-color: #f5f7ff;
        --white: #fff;
        --error-color: #ff4d4d;
        --text-color: #333;
        --border-color: #ddd;
        --background-color: var(--secondary-color);
        --card-background: var(--white);
    }

    @media (prefers-color-scheme: dark) {
        :root {
            --secondary-color: #1a1a1a;
            --white: #2d2d2d;
            --text-color: #f0f0f0;
            --border-color: #444;
            --background-color: #121212;
            --card-background: var(--white);
        }
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Segoe UI', sans-serif;
    }

    body {
        background: var(--background-color);
        color: var(--text-color);
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        padding: 20px;
        transition: background 0.3s ease, color 0.3s ease;
    }

    .auth-container {
        width: 100%;
        max-width: 400px;
        background: var(--card-background);
        border-radius: 12px;
        padding: 30px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        transition: background 0.3s ease;
    }

    .auth-header {
        text-align: center;
        margin-bottom: 30px;
    }

    .auth-header h1 {
        color: var(--text-color);
    }

    .auth-header p {
        color: var(--text-color);
        opacity: 0.8;
    }

    .form-group {
        position: relative;
        margin-bottom: 35px;
    }

    .form-control {
        width: 100%;
        padding: 12px 15px;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        font-size: 16px;
        outline: none;
        transition: 0.3s;
        background-color: var(--card-background);
        color: var(--text-color);
    }

    /* Floating label */
    .floating-label {
        position: absolute;
        left: 15px;
        top: 12px;
        color: #999;
        font-size: 16px;
        pointer-events: none;
        transition: 0.3s ease;
        background: var(--card-background);
        padding: 0 5px;
    }

    .form-control:focus + .floating-label,
    .form-control:not(:placeholder-shown) + .floating-label {
        top: -10px;
        left: 10px;
        font-size: 12px;
        color: var(--primary-color);
    }

    .form-control:focus {
        border-color: var(--primary-color);
    }

    /* Error State */
    .form-group.error .form-control {
        border-color: var(--error-color);
    }

    /* Error icon */
    .error-icon {
        position: absolute;
        top: 50%;
        right: 10px;
        transform: translateY(-50%);
        width: 22px;
        height: 22px;
        background: var(--error-color);
        color: white;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        font-weight: bold;
        opacity: 0;
        pointer-events: none;
        transition: 0.3s;
    }

    .form-group.error .error-icon {
        opacity: 1;
    }

    /* Tooltip (red text) */
    .tooltip {
        position: absolute;
        top: 50%;
        right: 40px;
        transform: translateY(-50%) translateX(20px);
        color: var(--error-color);
        font-size: 14px;
        font-weight: bold;
        white-space: nowrap;
        opacity: 0;
        transition: 0.3s ease;
    }

    .form-group.error .tooltip {
        opacity: 1;
        transform: translateY(-50%) translateX(0);
    }

    .btn {
        width: 100%;
        padding: 14px;
        background: var(--primary-color);
        color: white;
        border: none;
        border-radius: 8px;
        font-weight: bold;
        font-size: 16px;
        cursor: pointer;
        margin-top: 10px;
        transition: opacity 0.3s;
    }

    .btn:hover { opacity: 0.9; }

    /* Auth footer */
    .auth-footer {
        text-align: center;
        margin-top: 15px;
        font-size: 14px;
        color: var(--text-color);
    }
    .auth-footer a {
        color: var(--primary-color);
        text-decoration: none;
        font-weight: bold;
    }
    .auth-footer a:hover {
        text-decoration: underline;
    }

    /* Password strength meter */
    .password-strength {
        width: 100%;
        height: 4px;
        background: #eee;
        margin-top: 8px;
        border-radius: 2px;
        overflow: hidden;
    }

    .password-strength-fill {
        height: 100%;
        width: 0%;
        background: var(--error-color);
        transition: width 0.3s, background 0.3s;
    }

    /* Toast notification */
    .toast {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: #4CAF50;
        color: white;
        padding: 12px 24px;
        border-radius: 4px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: 1000;
    }

    .toast.show {
        opacity: 1;
    }

</style>
</head>
<body>
    <div class="auth-container">
        <div class="auth-header">
            <h1>Create Account</h1>
            <p>Join Social Service today</p>
        </div>

        <form id="signup-form" novalidate>
            <div class="form-group">
                <input type="text" id="name" class="form-control" placeholder=" ">
                <label for="name" class="floating-label">Full Name</label>
                <div class="error-icon">!</div>
                <div class="tooltip">Name is required</div>
            </div>

            <div class="form-group">
                <input type="email" id="email" class="form-control" placeholder=" ">
                <label for="email" class="floating-label">Email Address</label>
                <div class="error-icon">!</div>
                <div class="tooltip">Email is required</div>
            </div>

            <div class="form-group">
                <input type="tel" id="number" class="form-control" placeholder=" " maxlength="11">
                <label for="number" class="floating-label">Phone Number</label>
                <div class="error-icon">!</div>
                <div class="tooltip">Valid phone number required</div>
            </div>

            <div class="form-group">
                <input type="password" id="password" class="form-control" placeholder=" ">
                <label for="password" class="floating-label">Password</label>
                <div class="error-icon">!</div>
                <div class="tooltip">Password required</div>
                <div class="password-strength">
                    <div class="password-strength-fill" id="password-strength-fill"></div>
                </div>
            </div>

            <div class="form-group">
                <input type="password" id="confirm-password" class="form-control" placeholder=" ">
                <label for="confirm-password" class="floating-label">Confirm Password</label>
                <div class="error-icon">!</div>
                <div class="tooltip">Confirm your password</div>
            </div>

            <button type="submit" class="btn">Sign Up</button>

            <div class="auth-footer">
                Already have an account? <a href="signin.html">Sign In</a>
            </div>
        </form>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

<script>
    // Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyCEn86IfdTNcvEmQuNP-KCvrmMABagcdkc",
        authDomain: "web-iatz.firebaseapp.com",
        projectId: "web-iatz",
        storageBucket: "web-iatz.firebasestorage.app",
        messagingSenderId: "264921056318",
        appId: "1:264921056318:web:c77e93fad660665bdfbd6f"
    };
     
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const database = firebase.database();

    const form = document.getElementById('signup-form');
    const inputs = form.querySelectorAll('.form-control');
    const toast = document.getElementById('toast');

    function showToast(message, isSuccess = true) {
        toast.textContent = message;
        toast.style.backgroundColor = isSuccess ? '#4CAF50' : '#f44336';
        toast.classList.add('show');
        
        setTimeout(() => {
            toast.classList.remove('show');
        }, 3000);
    }

    // Password strength checker
    const passwordInput = document.getElementById('password');
    const strengthFill = document.getElementById('password-strength-fill');

    passwordInput.addEventListener('input', checkPasswordStrength);

    function checkPasswordStrength() {
        const password = passwordInput.value;
        let strength = 0;
        
        // Check length
        if (password.length >= 8) {
            strength += 50;
        }
        
        // Check letters (either uppercase or lowercase)
        if (/[A-Za-z]/.test(password)) {
            strength += 50;
        }
        
        // Update strength meter
        strengthFill.style.width = strength + '%';
        
        // Change color based on strength
        if (strength < 50) {
            strengthFill.style.backgroundColor = 'var(--error-color)';
        } else if (strength < 100) {
            strengthFill.style.backgroundColor = '#ff9800';
        } else {
            strengthFill.style.backgroundColor = '#4CAF50';
        }
    }

    form.addEventListener('submit', function(e){
        e.preventDefault();

        // Clear old errors first
        inputs.forEach(input => input.parentElement.classList.remove('error'));

        let firstInvalid = null;

        // Check required fields
        for (let input of inputs) {
            if (!input.value.trim()) {
                input.parentElement.classList.add('error');
                if (!firstInvalid) {
                    firstInvalid = input;
                }
                break; // Stop at first error
            }
        }

        // Phone number validation (must be exactly 11 digits)
        const phoneNumber = document.getElementById('number').value;
        if (phoneNumber && (phoneNumber.length !== 11 || !/^\d+$/.test(phoneNumber))) {
            document.getElementById('number').parentElement.classList.add('error');
            document.getElementById('number').parentElement.querySelector('.tooltip').textContent = 'Must be 11 digits';
            if (!firstInvalid) {
                firstInvalid = document.getElementById('number');
            }
        }

        // Password validation (simplified - just length and letters)
        const password = document.getElementById('password').value;
        if (password) {
            const hasMinLength = password.length >= 8;
            const hasLetters = /[A-Za-z]/.test(password);
            
            if (!hasMinLength || !hasLetters) {
                document.getElementById('password').parentElement.classList.add('error');
                document.getElementById('password').parentElement.querySelector('.tooltip').textContent = 'Password must be at least 8 characters with letters';
                if (!firstInvalid) {
                    firstInvalid = document.getElementById('password');
                }
            }
        }

        // Password match check
        const confirmPassword = document.getElementById('confirm-password').value;
        if(!firstInvalid && password && confirmPassword && password !== confirmPassword){
            document.getElementById('confirm-password').parentElement.classList.add('error');
            document.getElementById('confirm-password').parentElement.querySelector('.tooltip').textContent = 'Passwords do not match';
            firstInvalid = document.getElementById('confirm-password');
        }

        if(firstInvalid){
            firstInvalid.focus();
            return;
        }

        // Get form values
        const name = document.getElementById('name').value;
        const email = document.getElementById('email').value;
        
        // Create user with Firebase Authentication
        auth.createUserWithEmailAndPassword(email, password)
            .then((userCredential) => {
                // User created successfully
                const user = userCredential.user;
                
                // Get current date and time
                const now = new Date();
                const createTime = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                const createDate = now.toLocaleDateString('en-GB'); // DD/MM/YYYY format
                
                // Save additional user data to Realtime Database
                const userData = {
                    name: name,
                    email: email,
                    phoneNumber: phoneNumber,
                    createTime: createTime,
                    createDate: createDate,
                    uid: user.uid
                };
                
                // Save to database under 'users' node with UID as key
                return database.ref('users/' + user.uid).set(userData);
            })
            .then(() => {
                // Show success toast
                showToast('Sign up successful! Redirecting...');
                
                // Redirect to sign in page after 2 seconds
                setTimeout(() => {
                    window.location.href = 'signin.html';
                }, 2000);
            })
            .catch((error) => {
                console.error('Error:', error);
                let errorMessage = 'An error occurred. Please try again.';
                
                if (error.code === 'auth/email-already-in-use') {
                    errorMessage = 'Email is already in use.';
                    document.getElementById('email').parentElement.classList.add('error');
                    document.getElementById('email').parentElement.querySelector('.tooltip').textContent = errorMessage;
                    document.getElementById('email').focus();
                } else if (error.code === 'auth/weak-password') {
                    errorMessage = 'Password should be at least 6 characters.';
                    document.getElementById('password').parentElement.classList.add('error');
                    document.getElementById('password').parentElement.querySelector('.tooltip').textContent = errorMessage;
                    document.getElementById('password').focus();
                } else if (error.code === 'auth/invalid-email') {
                    errorMessage = 'Invalid email address.';
                    document.getElementById('email').parentElement.classList.add('error');
                    document.getElementById('email').parentElement.querySelector('.tooltip').textContent = errorMessage;
                    document.getElementById('email').focus();
                }
                
                showToast(errorMessage, false);
            });
    });

    // Remove error on typing
    inputs.forEach(input => {
        input.addEventListener('input', ()=>{
            if(input.value.trim()){
                input.parentElement.classList.remove('error');
            }
        });
    });

    // Phone number input validation (only numbers)
    document.getElementById('number').addEventListener('input', function(e) {
        this.value = this.value.replace(/[^0-9]/g, '');
    });

    // Focus the input when clicking anywhere in the form-group
    document.querySelectorAll('.form-group').forEach(group => {
        group.addEventListener('click', (e) => {
            if (e.target !== group) return;
            const input = group.querySelector('.form-control');
            input.focus();
        });
    });
</script>
</body>
</html>